server {
    listen 80;
    server_name 192.168.56.4; # <--- YOUR SERVER IP

    # --- STATIC FILE CONFIGURATION ---
    # Nginx will look for index.html here:
    root /home/jobert/webapp/contact_app/frontend; 
    index index.html;
   # adding for FEATURE update support
    # Prevents Nginx from rejecting files over 50MB (adjust as needed)
    client_max_body_size 50M;

 # Nginx handles this request directly, bypassing Gunicorn
    location /documents/ {
        # Use the alias directive to map the URL prefix to the absolute file path
        alias /home/jobert/webapp/contact_app/filestore/;

        # Optional: Add security and performance headers
        internal; # Optional: Restrict external access; only accessible via internal redirects (if implemented)
        expires max; # Aggressive caching for files that won't change

        # Ensure that Nginx can only serve files, not list directories
        autoindex off;
    }
    location /api/ {
        # --- REVERSE PROXY CONFIGURATION ---
        # Forward requests starting with /api/ to Gunicorn on localhost:8000
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_redirect off; # Prevents issues with location headers
    }

    location / {
        # Serve static files (index.html, app.js, etc.) from the 'root' directory
        try_files $uri $uri/ =404;
    }
}
